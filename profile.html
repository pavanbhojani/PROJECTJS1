<h1>Profile update</h1>

<form>
    <table border="1">
        <tr>
            <td>Name :- </td>
            <td><input type="text" id="name"></td>
        </tr>
        <tr>
            <td>Email :- </td>
            <td><input type="text" id="email"></td>
        </tr>
        <tr>
            <td>Password :- </td>
            <td><input type="text" id="password"></td>
        </tr>
        <tr>
            <td>File upload :- </td>
            <td>
                <input type="file" id="image">
                <img id="imageshow" width="100"/>
            </td>
        </tr>
        <tr>
            <td></td>
            <td>
                <input type="button" value="Profile" onclick="profile()"/>
            </td>
        </tr>
    </table>
</form>


<script src="./checkUserLogin.js" type="text/javascript"></script>
<script type="text/javascript">

    let val = JSON.parse(localStorage.getItem('checkUserLogin'));
    document.getElementById('name').value = val.name;
    document.getElementById('email').value = val.email;
    document.getElementById('password').value = val.password;
    document.getElementById('imageshow').setAttribute('src',val.image);

    function profile(){
        let name = document.getElementById('name').value;
        let email = document.getElementById('email').value;
        let password = document.getElementById('password').value;

        
        let image = document.getElementById('image').value;
        let imagename = image.replace(/^.*[\\\/]/, ''); //fekpath remove karyo
        let path = "images/"+imagename;

        let allrec = JSON.parse(localStorage.getItem('register'));

        for(let i in allrec){
            if(allrec[i].uniqid == val.uniqid){
                allrec[i].name = name;
                allrec[i].email = email;
                allrec[i].password = password;
                allrec[i].image = path;
            }
            localStorage.setItem('register',JSON.stringify(allrec));
        }
        alert("Profile successfully update");
        window.location.href = "dashboard.html";
        
        
    }


</script>